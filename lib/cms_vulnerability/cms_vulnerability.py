#!/usr/bin/python
# -*- coding: UTF-8 -*-

from lib.core import Messages

def cms_vulnerability(url):
    messages = Messages()
    feature_dict = {
        '/static/image/common/focus.swf':'discuz X3 focus.swf flashxss',
        '/forum.php?mod=ajax&action=downremoteimg&message=[img=1,1]':'discuz forum.php message SSRF',
        '/plugin.php?id=nds_up_ques:nds_ques_viewanswer&srchtxt=1&orderby=':'discuz orderby SQLi',
        '/uc_server/control/admin/db.php':'discuz! X2.5 path disclosure',
        '/source/plugin/myrepeats/table/table_myrepeats.php':'discuz! X2.5 path disclosure',
        '/install/include/install_lang.php':'discuz! X2.5 path disclosure',
        '/plus/recommend.php?aid=1&_FILES[type][name]&_FILES[type][size]&_FILES':'dedecms recommend.php SQLi',
        '/plus/search.php?keyword=test&typeArr':'dedecms search.php SQLi',
        '/index.php?c=article&a=index&category[0]==0))':'Onethink category SQLi',
        '/index.php/Index/index/name/$':'ThinkPHP Code Exec',
        '/download.jspx?fpath=WEB-INF/web.xml&filename=WEB-INF/web.xml':'jeecms download.jsp fpath file download',
        '/api.php?op=get_menu&act=ajax_getlist&callback=aaaaa&parentid=0&key=authkey&cachefile=..':'phpcms authkey disclosure',
        '/digg/digg_add.php?id=1&con=2&digg_mod=digg_data':'phpcms digg_add.php SQLi',
        '/yp/product.php?pagesize=${@phpinfo()}':'phpcms2008 product.php RCE',
        '/index.php?m=content&c=down&a_k=':'phpcms v9.6.0 SQLi',
        '/index.php?m=attachment&c=attachments&a=swfupload_json&aid=1&filename=test.jpg&src=':'phpcms 9.6.1 Arbitrary File Read',
        '/components/com_docman/dl2.php?archive=0&file=Li4vY29uZmlndXJhdGlvbi5waHA=':'joomla com_docman Local File Include',
        '/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=':'joomla 3.7.0 core SQLi',
        '/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php':'wordpress admin-ajax.php Arbitrary File Download'
    }
    for keys in feature_dict.keys():
        if keys in url:
            messages.vulnerability_cms_vul_find(feature_dict[keys])
            return True
    return False
